# ClipAiMan å¤šç«¯æ”¯æŒæ¶æ„æ–¹æ¡ˆ

> åˆ›å»ºæ—¥æœŸ: 2026-02-22

---

## ä¸€ã€æ¶æ„è®¾è®¡

### 1.1 å¤šç«¯æ¶æ„å›¾

```
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚           å…±äº«ä¸šåŠ¡é€»è¾‘å±‚                 â”‚
                    â”‚   (Core Services / Hooks / Types)      â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                     â†‘
          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
          â”‚                          â”‚                          â”‚
          â–¼                          â–¼                          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      Web ç«¯          â”‚  â”‚    Desktop ç«¯        â”‚  â”‚    ç§»åŠ¨ç«¯            â”‚
â”‚   (Vite + React)    â”‚  â”‚    (Tauri)          â”‚  â”‚    (Taro)          â”‚
â”‚                     â”‚  â”‚                     â”‚  â”‚                     â”‚
â”‚ - æµè§ˆå™¨è¿è¡Œ         â”‚  â”‚ - Windows           â”‚  â”‚ - iOS               â”‚
â”‚ - åŠŸèƒ½å®Œæ•´          â”‚  â”‚ - macOS             â”‚  â”‚ - Android           â”‚
â”‚ - å“åº”å¼å¸ƒå±€        â”‚  â”‚ - Linux             â”‚  â”‚ - H5               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 1.2 ç›®å½•ç»“æ„

```
clip-ai-man/
â”œâ”€â”€ packages/
â”‚   â”œâ”€â”€ core/                 # å…±äº«æ ¸å¿ƒ (NEW)
â”‚   â”‚   â”œâ”€â”€ services/         # ä¸šåŠ¡æœåŠ¡
â”‚   â”‚   â”œâ”€â”€ hooks/            # çŠ¶æ€Hooks
â”‚   â”‚   â”œâ”€â”€ types/            # ç±»å‹å®šä¹‰
â”‚   â”‚   â”œâ”€â”€ utils/            # å·¥å…·å‡½æ•°
â”‚   â”‚   â””â”€â”€ constants/        # å¸¸é‡
â”‚   â”‚
â”‚   â”œâ”€â”€ web/                  # Web ç«¯ (ç°æœ‰)
â”‚   â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â””â”€â”€ vite.config.ts
â”‚   â”‚
â”‚   â”œâ”€â”€ desktop/              # Desktop ç«¯ (ç°æœ‰ Tauri)
â”‚   â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â””â”€â”€ src-tauri/
â”‚   â”‚
â”‚   â””â”€â”€ mobile/               # ç§»åŠ¨ç«¯ (NEW - Taro)
â”‚       â”œâ”€â”€ src/
â”‚       â””â”€â”€ config/
â”‚
â”œâ”€â”€ package.json              # æ ¹ workspace é…ç½®
```

---

## äºŒã€æŠ€æœ¯é€‰å‹

### 2.1 å„ç«¯æŠ€æœ¯æ ˆ

| ç«¯ | æ¡†æ¶ | æ„å»ºå·¥å…· | çŠ¶æ€ |
|----|------|----------|------|
| Web | React 18 | Vite 4 | âœ… ç°æœ‰ |
| Desktop | React 18 + Tauri | Vite + Rust | âœ… ç°æœ‰ |
| Mobile | Taro 4 (React) | Vite 7 | ğŸ“‹ å¾…å¼€å‘ |

### 2.2 ä»£ç å…±äº«ç­–ç•¥

| ç±»å‹ | å…±äº«æ–¹å¼ |
|------|----------|
| ä¸šåŠ¡æœåŠ¡ | `@clipaiman/core` åŒ… |
| ç±»å‹å®šä¹‰ | `@clipaiman/types` |
| Hooks | æ¡ä»¶å¯¼å‡º |
| Utils | çº¯å‡½æ•°å¯å…±äº« |
| ç»„ä»¶ | å„ç«¯ç‹¬ç«‹å®ç° |

---

## ä¸‰ã€å®æ–½è®¡åˆ’

### Phase 1: æå–æ ¸å¿ƒå±‚
- [ ] åˆ›å»º `packages/core` ç›®å½•
- [ ] ç§»åŠ¨ services åˆ° core
- [ ] ç§»åŠ¨ types åˆ° core
- [ ] åˆ›å»º workspace é…ç½®

### Phase 2: é€‚é…ç°æœ‰ç«¯
- [ ] Web ç«¯ä½¿ç”¨ @clipaiman/core
- [ ] Desktop ç«¯ä½¿ç”¨ @clipaiman/core

### Phase 3: ç§»åŠ¨ç«¯å¼€å‘
- [ ] åˆå§‹åŒ– Taro é¡¹ç›®
- [ ] é›†æˆ @clipaiman/core
- [ ] é€‚é…ç§»åŠ¨ç«¯ç»„ä»¶
- [ ] å“åº”å¼å¸ƒå±€

---

## å››ã€ç»„ä»¶é€‚é…

### 4.1 éœ€è¦å„ç«¯ç‹¬ç«‹å®ç°çš„ç»„ä»¶

| ç»„ä»¶ | Web | Desktop | Mobile |
|------|-----|---------|--------|
| è§†é¢‘æ’­æ”¾å™¨ | âœ… | âœ… | éœ€é€‚é… |
| æ–‡ä»¶ä¸Šä¼  | âœ… | âœ… | éœ€é€‚é… |
| Canvas ç»˜å›¾ | âœ… | âœ… | éœ€é€‚é… |
| å¯¼èˆªèœå• | ä¾§è¾¹æ  | ä¾§è¾¹æ  | åº•éƒ¨ Tab |

### 4.2 å¹³å°æ£€æµ‹

```typescript
// å¹³å°æ£€æµ‹
import { isWeb, isDesktop, isMobile, isIOS, isAndroid } from '@clipaiman/core/utils/platform';

// ä½¿ç”¨ç¤ºä¾‹
if (isMobile()) {
  // æ˜¾ç¤ºç§»åŠ¨ç«¯ä¸“å± UI
}
```

---

## äº”ã€API é€‚é…å±‚

### 5.1 å­˜å‚¨é€‚é…

```typescript
// ç»Ÿä¸€å­˜å‚¨æ¥å£
interface StorageAdapter {
  get(key: string): any;
  set(key: string, value: any): void;
  remove(key: string): void;
}

// å„ç«¯å®ç°
class WebStorage implements StorageAdapter { ... }
class TauriStorage implements StorageAdapter { ... }
class MiniStorage implements StorageAdapter { ... }
```

### 5.2 æ–‡ä»¶ç³»ç»Ÿ

```typescript
// æ–‡ä»¶æ“ä½œæ¥å£
interface FileSystemAdapter {
  readFile(path: string): Promise<Uint8Array>;
  writeFile(path: string, data: Uint8Array): Promise<void>;
  selectFile(options: FileSelectOptions): Promise<string>;
}
```

---

## å…­ã€è¿ç§»æ­¥éª¤

### Step 1: åˆ›å»º Core åŒ…
```bash
mkdir -p packages/core/{src/services,src/hooks,src/types,src/utils}
```

### Step 2: é…ç½® Workspace
```json
// package.json
{
  "private": true,
  "workspaces": ["packages/*"]
}
```

### Step 3: è¿ç§»æœåŠ¡
- ç§»åŠ¨ `src/core/services/` â†’ `packages/core/src/services/`
- ç§»åŠ¨ `src/core/types/` â†’ `packages/core/src/types/`
- æ›´æ–°å¯¼å…¥è·¯å¾„

### Step 4: å®‰è£… Taro
```bash
npm install @tarojs/cli@4
taro init packages/mobile
```

---

## ä¸ƒã€æ³¨æ„äº‹é¡¹

1. **æ¸è¿›å¼è¿ç§»** - ä¸å½±å“ç°æœ‰åŠŸèƒ½
2. **ç±»å‹å®‰å…¨** - å…±äº« TypeScript ç±»å‹
3. **å¹³å°ç‰¹æ€§** - å„ç«¯ä¿ç•™ç‰¹æœ‰èƒ½åŠ›
4. **æ„å»ºä¼˜åŒ–** - æŒ‰éœ€åŠ è½½

---

*æœ¬æ–¹æ¡ˆå°†æ ¹æ®é¡¹ç›®è¿›å±•æŒç»­æ›´æ–°*
